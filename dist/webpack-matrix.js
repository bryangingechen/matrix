!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.matrix=r():t.matrix=r()}(window,function(){return function(t){var r={};function e(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,s){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(s,o,function(r){return t[r]}.bind(null,o));return s},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=1)}([function(t,r,e){"use strict";const s=Object.prototype.toString;t.exports=function(t){return s.call(t).endsWith("Array]")}},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s,o=(s=e(2))&&"object"==typeof s&&"default"in s?s.default:s;function i(t,r,e){var s=e?t.rows:t.rows-1;if(r<0||r>s)throw new RangeError("Row index out of range")}function n(t,r,e){var s=e?t.columns:t.columns-1;if(r<0||r>s)throw new RangeError("Column index out of range")}function a(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function h(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function u(t,r,e){return{row:f(t,r),column:c(t,e)}}function f(t,r){if("object"!=typeof r)throw new TypeError("unexpected type for row indices");if(r.some(r=>r<0||r>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function c(t,r){if("object"!=typeof r)throw new TypeError("unexpected type for column indices");if(r.some(r=>r<0||r>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function g(t,r,e,s,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(m("startRow",r),m("endRow",e),m("startColumn",s),m("endColumn",o),r>e||s>o||r<0||r>=t.rows||e<0||e>=t.rows||s<0||s>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function l(t,r=0){for(var e=[],s=0;s<t;s++)e.push(r);return e}function m(t,r){if("number"!=typeof r)throw new TypeError(`${t} must be a number`)}const w=15,p=10,v=8;function d(t){const r=String(t);if(r.length<=v)return r.padEnd(v," ");const e=t.toPrecision(v-2);if(e.length<=v)return e;const s=t.toExponential(v-2),o=s.indexOf("e"),i=s.substring(o);return s.substring(0,v-i.length)+i}class M{static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("data length does not match given dimensions");for(var s=new y(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)s.set(o,i,e[o*r+i]);return s}static rowVector(t){for(var r=new y(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){for(var r=new y(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static zeros(t,r){return new y(t,r)}static ones(t,r){return new y(t,r).fill(1)}static rand(t,r,e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{random:s=Math.random}=e;for(var o=new y(t,r),i=0;i<t;i++)for(var n=0;n<r;n++)o.set(i,n,s());return o}static randInt(t,r,e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{min:s=0,max:o=1e3,random:i=Math.random}=e;if(!Number.isInteger(s))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(s>=o)throw new RangeError("min must be smaller than max");for(var n=o-s,a=new y(t,r),h=0;h<t;h++)for(var u=0;u<r;u++){var f=s+Math.round(i()*n);a.set(h,u,f)}return a}static eye(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var s=Math.min(t,r),o=this.zeros(t,r),i=0;i<s;i++)o.set(i,i,e);return o}static diag(t,r,e){var s=t.length;void 0===r&&(r=s),void 0===e&&(e=r);for(var o=Math.min(s,r,e),i=this.zeros(r,e),n=0;n<o;n++)i.set(n,n,t[n]);return i}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,s=t.columns,o=new y(e,s),i=0;i<e;i++)for(var n=0;n<s;n++)o.set(i,n,Math.min(t.get(i,n),r.get(i,n)));return o}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,s=t.columns,o=new this(e,s),i=0;i<e;i++)for(var n=0;n<s;n++)o.set(i,n,Math.max(t.get(i,n),r.get(i,n)));return o}static checkMatrix(t){return M.isMatrix(t)?t:new y(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.call(this,r,e);return this}to1DArray(){for(var t=[],r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.push(this.get(r,e));return t}to2DArray(){for(var t=[],r=0;r<this.rows;r++){t.push([]);for(var e=0;e<this.columns;e++)t[r].push(this.get(r,e))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}isEchelonForm(){let t=0,r=0,e=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(r=0,o=!1;r<this.columns&&!1===o;)0===this.get(t,r)?r++:1===this.get(t,r)&&r>e?(o=!0,e=r):(s=!1,o=!0);t++}return s}isReducedEchelonForm(){let t=0,r=0,e=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(r=0,o=!1;r<this.columns&&!1===o;)0===this.get(t,r)?r++:1===this.get(t,r)&&r>e?(o=!0,e=r):(s=!1,o=!0);for(let e=r+1;e<this.rows;e++)0!==this.get(t,e)&&(s=!1);t++}return s}set(t,r,e){throw new Error("set method is unimplemented")}get(t,r){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:r=1,columns:e=1}=t;if(!Number.isInteger(r)||r<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new TypeError("columns must be a positive integer");for(var s=new y(this.rows*r,this.columns*e),o=0;o<r;o++)for(var i=0;i<e;i++)s.setSubMatrix(this,this.rows*o,this.columns*i);return s}fill(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){i(this,t);for(var r=[],e=0;e<this.columns;e++)r.push(this.get(t,e));return r}getRowVector(t){return y.rowVector(this.getRow(t))}setRow(t,r){i(this,t),r=a(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){i(this,t),i(this,r);for(var e=0;e<this.columns;e++){var s=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,s)}return this}getColumn(t){n(this,t);for(var r=[],e=0;e<this.rows;e++)r.push(this.get(e,t));return r}getColumnVector(t){return y.columnVector(this.getColumn(t))}setColumn(t,r){n(this,t),r=h(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){n(this,t),n(this,r);for(var e=0;e<this.rows;e++){var s=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,s)}return this}addRowVector(t){t=a(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=a(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=a(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=a(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=h(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=h(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=h(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=h(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){i(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){n(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.get(e,s)>t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}min(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.get(e,s)<t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}maxRow(t){i(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){i(this,t);for(var r=this.get(t,0),e=[t,0],s=1;s<this.columns;s++)this.get(t,s)>r&&(r=this.get(t,s),e[1]=s);return e}minRow(t){i(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){i(this,t);for(var r=this.get(t,0),e=[t,0],s=1;s<this.columns;s++)this.get(t,s)<r&&(r=this.get(t,s),e[1]=s);return e}maxColumn(t){n(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){n(this,t);for(var r=this.get(0,t),e=[0,t],s=1;s<this.rows;s++)this.get(s,t)>r&&(r=this.get(s,t),e[0]=s);return e}minColumn(t){n(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){n(this,t);for(var r=this.get(0,t),e=[0,t],s=1;s<this.rows;s++)this.get(s,t)<r&&(r=this.get(s,t),e[0]=s);return e}diag(){for(var t=Math.min(this.rows,this.columns),r=[],e=0;e<t;e++)r.push(this.get(e,e));return r}norm(t="frobenius"){var r=0;if("max"===t)return this.max();if("frobenius"===t){for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)r+=this.get(e,s)*this.get(e,s);return Math.sqrt(r)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){M.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var e=0,s=0;s<r.length;s++)e+=r[s]*t[s];return e}mmul(t){t=y.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var r=this.rows,e=this.columns,s=t.columns,o=new y(r,s),i=new Array(e),n=0;n<s;n++){for(var a=0;a<e;a++)i[a]=t.get(a,n);for(var h=0;h<r;h++){var u=0;for(a=0;a<e;a++)u+=this.get(h,a)*i[a];o.set(h,n,u)}}return o}strassen2x2(t){t=y.checkMatrix(t);var r=new y(2,2);const e=this.get(0,0),s=t.get(0,0),o=this.get(0,1),i=t.get(0,1),n=this.get(1,0),a=t.get(1,0),h=this.get(1,1),u=t.get(1,1),f=(e+h)*(s+u),c=(n+h)*s,g=e*(i-u),l=h*(a-s),m=(e+o)*u,w=f+l-m+(o-h)*(a+u),p=g+m,v=c+l,d=f-c+g+(n-e)*(s+i);return r.set(0,0,w),r.set(0,1,p),r.set(1,0,v),r.set(1,1,d),r}strassen3x3(t){t=y.checkMatrix(t);var r=new y(3,3);const e=this.get(0,0),s=this.get(0,1),o=this.get(0,2),i=this.get(1,0),n=this.get(1,1),a=this.get(1,2),h=this.get(2,0),u=this.get(2,1),f=this.get(2,2),c=t.get(0,0),g=t.get(0,1),l=t.get(0,2),m=t.get(1,0),w=t.get(1,1),p=t.get(1,2),v=t.get(2,0),d=t.get(2,1),M=t.get(2,2),b=(e-i)*(-g+w),x=(-e+i+n)*(c-g+w),S=(i+n)*(-c+g),E=e*c,R=(-e+h+u)*(c-l+p),k=(-e+h)*(l-p),V=(h+u)*(-c+l),A=(-o+u+f)*(w+v-d),I=(o-f)*(w-d),T=o*v,q=(u+f)*(-v+d),C=(-o+n+a)*(p+v-M),N=(o-a)*(p-M),j=(n+a)*(-v+M),D=E+T+s*m,$=(e+s+o-i-n-u-f)*w+x+S+E+A+T+q,P=E+R+V+(e+s+o-n-a-h-u)*p+T+C+j,L=b+n*(-c+g+m-w-p-v+M)+x+E+T+C+N,z=b+x+S+E+a*d,O=T+C+N+j+i*l,F=E+R+k+u*(-c+l+m-w-p-v+d)+A+I+T,U=A+I+T+q+h*g,_=E+R+k+V+f*M;return r.set(0,0,D),r.set(0,1,$),r.set(0,2,P),r.set(1,0,L),r.set(1,1,z),r.set(1,2,O),r.set(2,0,F),r.set(2,1,U),r.set(2,2,_),r}mmulStrassen(t){t=y.checkMatrix(t);var r=this.clone(),e=r.rows,s=r.columns,o=t.rows,i=t.columns;function n(t,r,e){var s=t.rows,o=t.columns;if(s===r&&o===e)return t;var i=M.zeros(r,e);return i=i.setSubMatrix(t,0,0)}s!==o&&console.warn(`Multiplying ${e} x ${s} and ${o} x ${i} matrix: dimensions do not match.`);var a=Math.max(e,o),h=Math.max(s,i);return function t(r,e,s,o){if(s<=512||o<=512)return r.mmul(e);s%2==1&&o%2==1?(r=n(r,s+1,o+1),e=n(e,s+1,o+1)):s%2==1?(r=n(r,s+1,o),e=n(e,s+1,o)):o%2==1&&(r=n(r,s,o+1),e=n(e,s,o+1));var i=parseInt(r.rows/2,10),a=parseInt(r.columns/2,10),h=r.subMatrix(0,i-1,0,a-1),u=e.subMatrix(0,i-1,0,a-1),f=r.subMatrix(0,i-1,a,r.columns-1),c=e.subMatrix(0,i-1,a,e.columns-1),g=r.subMatrix(i,r.rows-1,0,a-1),l=e.subMatrix(i,e.rows-1,0,a-1),m=r.subMatrix(i,r.rows-1,a,r.columns-1),w=e.subMatrix(i,e.rows-1,a,e.columns-1),p=t(M.add(h,m),M.add(u,w),i,a),v=t(M.add(g,m),u,i,a),d=t(h,M.sub(c,w),i,a),b=t(m,M.sub(l,u),i,a),y=t(M.add(h,f),w,i,a),x=t(M.sub(g,h),M.add(u,c),i,a),S=t(M.sub(f,m),M.add(l,w),i,a),E=M.add(p,b);E.sub(y),E.add(S);var R=M.add(d,y),k=M.add(v,b),V=M.sub(p,v);V.add(d),V.add(x);var A=M.zeros(2*E.rows,2*E.columns);return(A=(A=(A=(A=A.setSubMatrix(E,0,0)).setSubMatrix(R,E.rows,0)).setSubMatrix(k,0,E.columns)).setSubMatrix(V,E.rows,E.columns)).subMatrix(0,s-1,0,o-1)}(r=n(r,a,h),t=n(t,a,h),a,h)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:e=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(r>=e)throw new RangeError("min must be smaller than max");for(var s=new y(this.rows,this.columns),i=0;i<this.rows;i++){const t=this.getRow(i);o(t,{min:r,max:e,output:t}),s.setRow(i,t)}return s}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:e=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(r>=e)throw new RangeError("min must be smaller than max");for(var s=new y(this.rows,this.columns),i=0;i<this.columns;i++){const t=this.getColumn(i);o(t,{min:r,max:e,output:t}),s.setColumn(i,t)}return s}flipRows(){const t=Math.ceil(this.columns/2);for(var r=0;r<this.rows;r++)for(var e=0;e<t;e++){var s=this.get(r,e),o=this.get(r,this.columns-1-e);this.set(r,e,o),this.set(r,this.columns-1-e,s)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(var r=0;r<this.columns;r++)for(var e=0;e<t;e++){var s=this.get(e,r),o=this.get(this.rows-1-e,r);this.set(e,r,o),this.set(this.rows-1-e,r,s)}return this}kroneckerProduct(t){t=y.checkMatrix(t);for(var r=this.rows,e=this.columns,s=t.rows,o=t.columns,i=new y(r*s,e*o),n=0;n<r;n++)for(var a=0;a<e;a++)for(var h=0;h<s;h++)for(var u=0;u<o;u++)i.set(s*n+h,o*a+u,this.get(n,a)*t.get(h,u));return i}transpose(){for(var t=new y(this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(t=b){for(var r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(t=b){for(var r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,s){g(this,t,r,e,s);for(var o=new y(r-t+1,s-e+1),i=t;i<=r;i++)for(var n=e;n<=s;n++)o.set(i-t,n-e,this.get(i,n));return o}subMatrixRow(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var s=new y(t.length,e-r+1),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);s.set(o,i-r,this.get(t[o],i))}return s}subMatrixColumn(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var s=new y(e-r+1,t.length),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);s.set(i-r,o,this.get(i,t[o]))}return s}setSubMatrix(t,r,e){g(this,r,r+(t=y.checkMatrix(t)).rows-1,e,e+t.columns-1);for(var s=0;s<t.rows;s++)for(var o=0;o<t.columns;o++)this.set(r+s,e+o,t.get(s,o));return this}selection(t,r){for(var e=u(this,t,r),s=new y(t.length,r.length),o=0;o<e.row.length;o++)for(var i=e.row[o],n=0;n<e.column.length;n++){var a=e.column[n];s.set(o,n,this.get(i,a))}return s}trace(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}clone(){for(var t=new y(this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}sum(t){switch(t){case"row":return function(t){for(var r=l(t.rows),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r[e]+=t.get(e,s);return r}(this);case"column":return function(t){for(var r=l(t.columns),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r[s]+=t.get(e,s);return r}(this);case void 0:return function(t){for(var r=0,e=0;e<t.rows;e++)for(var s=0;s<t.columns;s++)r+=t.get(e,s);return r}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){for(var r=l(t.rows,1),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r[e]*=t.get(e,s);return r}(this);case"column":return function(t){for(var r=l(t.columns,1),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r[s]*=t.get(e,s);return r}(this);case void 0:return function(t){for(var r=1,e=0;e<t.rows;e++)for(var s=0;s<t.columns;s++)r*=t.get(e,s);return r}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const r=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)r[t]/=this.columns;return r;case"column":for(let t=0;t<this.columns;t++)r[t]/=this.rows;return r;case void 0:return r/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,r={}){if("object"==typeof t&&(r=t,t=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{unbiased:e=!0,mean:s=this.mean(t)}=r;if("boolean"!=typeof e)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(s))throw new TypeError("mean must be an array");return function(t,r,e){const s=t.rows,o=t.columns,i=[];for(var n=0;n<s;n++){for(var a=0,h=0,u=0,f=0;f<o;f++)a+=u=t.get(f,n)-e[n],h+=u*u;r?i.push((h-a*a/o)/(o-1)):i.push((h-a*a/o)/o)}return i}(this,e,s);case"column":if(!Array.isArray(s))throw new TypeError("mean must be an array");return function(t,r,e){const s=t.rows,o=t.columns,i=[];for(var n=0;n<o;n++){for(var a=0,h=0,u=0,f=0;f<s;f++)a+=u=t.get(f,n)-e[n],h+=u*u;r?i.push((h-a*a/s)/(s-1)):i.push((h-a*a/s)/s)}return i}(this,e,s);case void 0:if("number"!=typeof s)throw new TypeError("mean must be a number");return function(t,r,e){const s=t.rows,o=t.columns,i=s*o;for(var n=0,a=0,h=0,u=0;u<s;u++)for(var f=0;f<o;f++)n+=h=t.get(u,f)-e,a+=h*h;return r?(a-n*n/i)/(i-1):(a-n*n/i)/i}(this,e,s);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,r){"object"==typeof t&&(r=t,t=void 0);const e=this.variance(t,r);if(void 0===t)return Math.sqrt(e);for(var s=0;s<e.length;s++)e[s]=Math.sqrt(e[s]);return e}}function b(t,r){return t-r}M.prototype.klass="Matrix","undefined"!=typeof Symbol&&(M.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){const t=" ".repeat(2),r=" ".repeat(4);return`${this.constructor.name} {\n${t}[\n${r}${function(t,r){const{rows:e,columns:s}=t,o=Math.min(e,w),i=Math.min(s,p),n=[];for(var a=0;a<o;a++){let r=[];for(var h=0;h<i;h++)r.push(d(t.get(a,h)));n.push(`${r.join(" ")}`)}return i!==s&&(n[n.length-1]+=` ... ${s-p} more columns`),o!==e&&n.push(`... ${e-w} more rows`),n.join(`\n${r}`)}(this,r)}\n${t}]\n${t}rows: ${this.rows}\n${t}columns: ${this.columns}\n}`}),M.random=M.rand,M.randomInt=M.randInt,M.diagonal=M.diag,M.prototype.diagonal=M.prototype.diag,M.identity=M.eye,M.prototype.negate=M.prototype.neg,M.prototype.tensorProduct=M.prototype.kroneckerProduct;class y extends M{constructor(t,r){if(super(),y.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(this.data=[],!(Number.isInteger(r)&&r>0))throw new TypeError("nColumns must be a positive integer");for(let e=0;e<t;e++){this.data.push([]);for(let t=0;t<r;t++)this.data[e].push(0)}}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const e=t;if(t=e.length,"number"!=typeof(r=e[0].length)||0===r)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let s=0;s<t;s++){if(e[s].length!==r)throw new RangeError("Inconsistent array dimensions");this.data.push(e[s].slice())}}}return this.rows=t,this.columns=r,this}set(t,r,e){return this.data[t][r]=e,this}get(t,r){return this.data[t][r]}removeRow(t){if(i(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.data.splice(t,1),this.rows-=1,this}addRow(t,r){return void 0===r&&(r=t,t=this.rows),i(this,t,!0),r=a(this,r),this.data.splice(t,0,r),this.rows+=1,this}removeColumn(t){if(n(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0;r<this.rows;r++)this.data[r].splice(t,1);return this.columns-=1,this}addColumn(t,r){void 0===r&&(r=t,t=this.columns),n(this,t,!0),r=h(this,r);for(var e=0;e<this.rows;e++)this.data[e].splice(t,0,r[e]);return this.columns+=1,this}}!function(t,r){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t);return this},t.prototype.addM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)+t.get(e,s));return this},t.add=function(t,e){return new r(t).add(e)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t);return this},t.prototype.subM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)-t.get(e,s));return this},t.sub=function(t,e){return new r(t).sub(e)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t);return this},t.prototype.mulM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)*t.get(e,s));return this},t.mul=function(t,e){return new r(t).mul(e)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t);return this},t.prototype.divM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)/t.get(e,s));return this},t.div=function(t,e){return new r(t).div(e)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)%t);return this},t.prototype.modM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)%t.get(e,s));return this},t.mod=function(t,e){return new r(t).mod(e)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)&t);return this},t.prototype.andM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)&t.get(e,s));return this},t.and=function(t,e){return new r(t).and(e)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)|t);return this},t.prototype.orM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)|t.get(e,s));return this},t.or=function(t,e){return new r(t).or(e)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)^t);return this},t.prototype.xorM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)^t.get(e,s));return this},t.xor=function(t,e){return new r(t).xor(e)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)<<t);return this},t.prototype.leftShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)<<t.get(e,s));return this},t.leftShift=function(t,e){return new r(t).leftShift(e)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)>>t.get(e,s));return this},t.signPropagatingRightShift=function(t,e){return new r(t).signPropagatingRightShift(e)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,this.get(e,s)>>>t.get(e,s));return this},t.rightShift=function(t,e){return new r(t).rightShift(e)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,~this.get(t,r));return this},t.not=function(t){return new r(t).not()},t.prototype.abs=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.abs(this.get(t,r)));return this},t.abs=function(t){return new r(t).abs()},t.prototype.acos=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.acos(this.get(t,r)));return this},t.acos=function(t){return new r(t).acos()},t.prototype.acosh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.acosh(this.get(t,r)));return this},t.acosh=function(t){return new r(t).acosh()},t.prototype.asin=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.asin(this.get(t,r)));return this},t.asin=function(t){return new r(t).asin()},t.prototype.asinh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.asinh(this.get(t,r)));return this},t.asinh=function(t){return new r(t).asinh()},t.prototype.atan=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.atan(this.get(t,r)));return this},t.atan=function(t){return new r(t).atan()},t.prototype.atanh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.atanh(this.get(t,r)));return this},t.atanh=function(t){return new r(t).atanh()},t.prototype.cbrt=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.cbrt(this.get(t,r)));return this},t.cbrt=function(t){return new r(t).cbrt()},t.prototype.ceil=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.ceil(this.get(t,r)));return this},t.ceil=function(t){return new r(t).ceil()},t.prototype.clz32=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.clz32(this.get(t,r)));return this},t.clz32=function(t){return new r(t).clz32()},t.prototype.cos=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.cos(this.get(t,r)));return this},t.cos=function(t){return new r(t).cos()},t.prototype.cosh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.cosh(this.get(t,r)));return this},t.cosh=function(t){return new r(t).cosh()},t.prototype.exp=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.exp(this.get(t,r)));return this},t.exp=function(t){return new r(t).exp()},t.prototype.expm1=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.expm1(this.get(t,r)));return this},t.expm1=function(t){return new r(t).expm1()},t.prototype.floor=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.floor(this.get(t,r)));return this},t.floor=function(t){return new r(t).floor()},t.prototype.fround=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.fround(this.get(t,r)));return this},t.fround=function(t){return new r(t).fround()},t.prototype.log=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log(this.get(t,r)));return this},t.log=function(t){return new r(t).log()},t.prototype.log1p=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log1p(this.get(t,r)));return this},t.log1p=function(t){return new r(t).log1p()},t.prototype.log10=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log10(this.get(t,r)));return this},t.log10=function(t){return new r(t).log10()},t.prototype.log2=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log2(this.get(t,r)));return this},t.log2=function(t){return new r(t).log2()},t.prototype.round=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.round(this.get(t,r)));return this},t.round=function(t){return new r(t).round()},t.prototype.sign=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sign(this.get(t,r)));return this},t.sign=function(t){return new r(t).sign()},t.prototype.sin=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sin(this.get(t,r)));return this},t.sin=function(t){return new r(t).sin()},t.prototype.sinh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sinh(this.get(t,r)));return this},t.sinh=function(t){return new r(t).sinh()},t.prototype.sqrt=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sqrt(this.get(t,r)));return this},t.sqrt=function(t){return new r(t).sqrt()},t.prototype.tan=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.tan(this.get(t,r)));return this},t.tan=function(t){return new r(t).tan()},t.prototype.tanh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.tanh(this.get(t,r)));return this},t.tanh=function(t){return new r(t).tanh()},t.prototype.trunc=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.trunc(this.get(t,r)));return this},t.trunc=function(t){return new r(t).trunc()},t.pow=function(t,e){return new r(t).pow(e)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,Math.pow(this.get(r,e),t));return this},t.prototype.powM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.set(e,s,Math.pow(this.get(e,s),t.get(e,s)));return this}}(M,y);class x extends M{constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}}class S extends x{constructor(t,r,e){var s=u(t,r,e);super(t,s.row.length,s.column.length),this.rowIndices=s.row,this.columnIndices=s.column}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}class E extends M{constructor(t,r={}){const{rows:e=1}=r;if(t.length%e!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=e,this.columns=t.length/e,this.data=t}set(t,r,e){var s=this._calculateIndex(t,r);return this.data[s]=e,this}get(t,r){var e=this._calculateIndex(t,r);return this.data[e]}_calculateIndex(t,r){return t*this.columns+r}}class R extends M{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,r,e){return this.data[t][r]=e,this}get(t,r){return this.data[t][r]}}class k{constructor(t){var r,e,s,o,i,n,a,h,u,f=(t=R.checkMatrix(t)).clone(),c=f.rows,g=f.columns,l=new Array(c),m=1;for(r=0;r<c;r++)l[r]=r;for(h=new Array(c),e=0;e<g;e++){for(r=0;r<c;r++)h[r]=f.get(r,e);for(r=0;r<c;r++){for(u=Math.min(r,e),i=0,s=0;s<u;s++)i+=f.get(r,s)*h[s];h[r]-=i,f.set(r,e,h[r])}for(o=e,r=e+1;r<c;r++)Math.abs(h[r])>Math.abs(h[o])&&(o=r);if(o!==e){for(s=0;s<g;s++)n=f.get(o,s),f.set(o,s,f.get(e,s)),f.set(e,s,n);a=l[o],l[o]=l[e],l[e]=a,m=-m}if(e<c&&0!==f.get(e,e))for(r=e+1;r<c;r++)f.set(r,e,f.get(r,e)/f.get(e,e))}this.LU=f,this.pivotVector=l,this.pivotSign=m}isSingular(){for(var t=this.LU,r=t.columns,e=0;e<r;e++)if(0===t.get(e,e))return!0;return!1}solve(t){t=y.checkMatrix(t);var r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,s,o,i=t.columns,n=t.subMatrixRow(this.pivotVector,0,i-1),a=r.columns;for(o=0;o<a;o++)for(e=o+1;e<a;e++)for(s=0;s<i;s++)n.set(e,s,n.get(e,s)-n.get(o,s)*r.get(e,o));for(o=a-1;o>=0;o--){for(s=0;s<i;s++)n.set(o,s,n.get(o,s)/r.get(o,o));for(e=0;e<o;e++)for(s=0;s<i;s++)n.set(e,s,n.get(e,s)-n.get(o,s)*r.get(e,o))}return n}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,s=0;s<e;s++)r*=t.get(s,s);return r}get lowerTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,s=new y(r,e),o=0;o<r;o++)for(var i=0;i<e;i++)o>i?s.set(o,i,t.get(o,i)):o===i?s.set(o,i,1):s.set(o,i,0);return s}get upperTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,s=new y(r,e),o=0;o<r;o++)for(var i=0;i<e;i++)o<=i?s.set(o,i,t.get(o,i)):s.set(o,i,0);return s}get pivotPermutationVector(){return this.pivotVector.slice()}}function V(t,r){var e=0;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0}class A{constructor(t){var r,e,s,o,i=(t=R.checkMatrix(t)).clone(),n=t.rows,a=t.columns,h=new Array(a);for(s=0;s<a;s++){var u=0;for(r=s;r<n;r++)u=V(u,i.get(r,s));if(0!==u){for(i.get(s,s)<0&&(u=-u),r=s;r<n;r++)i.set(r,s,i.get(r,s)/u);for(i.set(s,s,i.get(s,s)+1),e=s+1;e<a;e++){for(o=0,r=s;r<n;r++)o+=i.get(r,s)*i.get(r,e);for(o=-o/i.get(s,s),r=s;r<n;r++)i.set(r,e,i.get(r,e)+o*i.get(r,s))}}h[s]=-u}this.QR=i,this.Rdiag=h}solve(t){t=y.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var s,o,i,n,a=t.columns,h=t.clone(),u=r.columns;for(i=0;i<u;i++)for(o=0;o<a;o++){for(n=0,s=i;s<e;s++)n+=r.get(s,i)*h.get(s,o);for(n=-n/r.get(i,i),s=i;s<e;s++)h.set(s,o,h.get(s,o)+n*r.get(s,i))}for(i=u-1;i>=0;i--){for(o=0;o<a;o++)h.set(i,o,h.get(i,o)/this.Rdiag[i]);for(s=0;s<i;s++)for(o=0;o<a;o++)h.set(s,o,h.get(s,o)-h.get(i,o)*r.get(s,i))}return h.subMatrix(0,u-1,0,a-1)}isFullRank(){for(var t=this.QR.columns,r=0;r<t;r++)if(0===this.Rdiag[r])return!1;return!0}get upperTriangularMatrix(){var t,r,e=this.QR,s=e.columns,o=new y(s,s);for(t=0;t<s;t++)for(r=0;r<s;r++)t<r?o.set(t,r,e.get(t,r)):t===r?o.set(t,r,this.Rdiag[t]):o.set(t,r,0);return o}get orthogonalMatrix(){var t,r,e,s,o=this.QR,i=o.rows,n=o.columns,a=new y(i,n);for(e=n-1;e>=0;e--){for(t=0;t<i;t++)a.set(t,e,0);for(a.set(e,e,1),r=e;r<n;r++)if(0!==o.get(e,e)){for(s=0,t=e;t<i;t++)s+=o.get(t,e)*a.get(t,r);for(s=-s/o[e][e],t=e;t<i;t++)a.set(t,r,a.get(t,r)+s*o.get(t,e))}}return a}}class I{constructor(t,r={}){var e=(t=R.checkMatrix(t)).rows,s=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:n=!1}=r;var a,h=Boolean(o),u=Boolean(i),f=!1;if(e<s)if(n){e=(a=t.transpose()).rows,s=a.columns,f=!0;var c=h;h=u,u=c}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();var g=Math.min(e,s),l=Math.min(e+1,s),m=new Array(l),w=new y(e,g),p=new y(s,s),v=new Array(s),d=new Array(e),M=new Array(l);for(let t=0;t<l;t++)M[t]=t;var b=Math.min(e-1,s),x=Math.max(0,Math.min(s-2,e)),S=Math.max(b,x);for(let t=0;t<S;t++){if(t<b){m[t]=0;for(let r=t;r<e;r++)m[t]=V(m[t],a.get(r,t));if(0!==m[t]){a.get(t,t)<0&&(m[t]=-m[t]);for(let r=t;r<e;r++)a.set(r,t,a.get(r,t)/m[t]);a.set(t,t,a.get(t,t)+1)}m[t]=-m[t]}for(let r=t+1;r<s;r++){if(t<b&&0!==m[t]){let s=0;for(let o=t;o<e;o++)s+=a.get(o,t)*a.get(o,r);s=-s/a.get(t,t);for(let o=t;o<e;o++)a.set(o,r,a.get(o,r)+s*a.get(o,t))}v[r]=a.get(t,r)}if(h&&t<b)for(let r=t;r<e;r++)w.set(r,t,a.get(r,t));if(t<x){v[t]=0;for(let r=t+1;r<s;r++)v[t]=V(v[t],v[r]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let r=t+1;r<s;r++)v[r]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<e&&0!==v[t]){for(let r=t+1;r<e;r++)d[r]=0;for(let r=t+1;r<e;r++)for(let e=t+1;e<s;e++)d[r]+=v[e]*a.get(r,e);for(let r=t+1;r<s;r++){let s=-v[r]/v[t+1];for(let o=t+1;o<e;o++)a.set(o,r,a.get(o,r)+s*d[o])}}if(u)for(let r=t+1;r<s;r++)p.set(r,t,v[r])}}let E=Math.min(s,e+1);if(b<s&&(m[b]=a.get(b,b)),e<E&&(m[E-1]=0),x+1<E&&(v[x]=a.get(x,E-1)),v[E-1]=0,h){for(let t=b;t<g;t++){for(let r=0;r<e;r++)w.set(r,t,0);w.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==m[t]){for(let r=t+1;r<g;r++){let s=0;for(let o=t;o<e;o++)s+=w.get(o,t)*w.get(o,r);s=-s/w.get(t,t);for(let o=t;o<e;o++)w.set(o,r,w.get(o,r)+s*w.get(o,t))}for(let r=t;r<e;r++)w.set(r,t,-w.get(r,t));w.set(t,t,1+w.get(t,t));for(let r=0;r<t-1;r++)w.set(r,t,0)}else{for(let r=0;r<e;r++)w.set(r,t,0);w.set(t,t,1)}}if(u)for(let t=s-1;t>=0;t--){if(t<x&&0!==v[t])for(let r=t+1;r<s;r++){let e=0;for(let o=t+1;o<s;o++)e+=p.get(o,t)*p.get(o,r);e=-e/p.get(t+1,t);for(let o=t+1;o<s;o++)p.set(o,r,p.get(o,r)+e*p.get(o,t))}for(let r=0;r<s;r++)p.set(r,t,0);p.set(t,t,1)}for(var k=E-1,A=Number.EPSILON;E>0;){let t,r;for(t=E-2;t>=-1&&-1!==t;t--){const r=Number.MIN_VALUE+A*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(v[t])<=r||Number.isNaN(v[t])){v[t]=0;break}}if(t===E-2)r=4;else{let e;for(e=E-1;e>=t&&e!==t;e--){let r=(e!==E?Math.abs(v[e]):0)+(e!==t+1?Math.abs(v[e-1]):0);if(Math.abs(m[e])<=A*r){m[e]=0;break}}e===t?r=3:e===E-1?r=1:(r=2,t=e)}switch(t++,r){case 1:{let r=v[E-2];v[E-2]=0;for(let e=E-2;e>=t;e--){let o=V(m[e],r),i=m[e]/o,n=r/o;if(m[e]=o,e!==t&&(r=-n*v[e-1],v[e-1]=i*v[e-1]),u)for(let t=0;t<s;t++)o=i*p.get(t,e)+n*p.get(t,E-1),p.set(t,E-1,-n*p.get(t,e)+i*p.get(t,E-1)),p.set(t,e,o)}break}case 2:{let r=v[t-1];v[t-1]=0;for(let s=t;s<E;s++){let o=V(m[s],r),i=m[s]/o,n=r/o;if(m[s]=o,r=-n*v[s],v[s]=i*v[s],h)for(let r=0;r<e;r++)o=i*w.get(r,s)+n*w.get(r,t-1),w.set(r,t-1,-n*w.get(r,s)+i*w.get(r,t-1)),w.set(r,s,o)}break}case 3:{const r=Math.max(Math.abs(m[E-1]),Math.abs(m[E-2]),Math.abs(v[E-2]),Math.abs(m[t]),Math.abs(v[t])),o=m[E-1]/r,i=m[E-2]/r,n=v[E-2]/r,a=m[t]/r,f=v[t]/r,c=((i+o)*(i-o)+n*n)/2,g=o*n*(o*n);let l=0;0===c&&0===g||(l=g/(c+(l=c<0?0-Math.sqrt(c*c+g):Math.sqrt(c*c+g))));let d=(a+o)*(a-o)+l,M=a*f;for(let r=t;r<E-1;r++){let o=V(d,M);0===o&&(o=Number.MIN_VALUE);let i=d/o,n=M/o;if(r!==t&&(v[r-1]=o),d=i*m[r]+n*v[r],v[r]=i*v[r]-n*m[r],M=n*m[r+1],m[r+1]=i*m[r+1],u)for(let t=0;t<s;t++)o=i*p.get(t,r)+n*p.get(t,r+1),p.set(t,r+1,-n*p.get(t,r)+i*p.get(t,r+1)),p.set(t,r,o);if(0===(o=V(d,M))&&(o=Number.MIN_VALUE),i=d/o,n=M/o,m[r]=o,d=i*v[r]+n*m[r+1],m[r+1]=-n*v[r]+i*m[r+1],M=n*v[r+1],v[r+1]=i*v[r+1],h&&r<e-1)for(let t=0;t<e;t++)o=i*w.get(t,r)+n*w.get(t,r+1),w.set(t,r+1,-n*w.get(t,r)+i*w.get(t,r+1)),w.set(t,r,o)}v[E-2]=d;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,u))for(let r=0;r<=k;r++)p.set(r,t,-p.get(r,t));for(;t<k&&!(m[t]>=m[t+1]);){let r=m[t];if(m[t]=m[t+1],m[t+1]=r,u&&t<s-1)for(let e=0;e<s;e++)r=p.get(e,t+1),p.set(e,t+1,p.get(e,t)),p.set(e,t,r);if(h&&t<e-1)for(let s=0;s<e;s++)r=w.get(s,t+1),w.set(s,t+1,w.get(s,t)),w.set(s,t,r);t++}E--}}if(f){var I=p;p=w,w=I}this.m=e,this.n=s,this.s=m,this.U=w,this.V=p}solve(t){var r=t,e=this.threshold,s=this.s.length,o=y.zeros(s,s);for(let t=0;t<s;t++)Math.abs(this.s[t])<=e?o.set(t,t,0):o.set(t,t,1/this.s[t]);var i=this.U,n=this.rightSingularVectors,a=n.mmul(o),h=n.rows,u=i.rows,f=y.zeros(h,u);for(let t=0;t<h;t++)for(let r=0;r<u;r++){let e=0;for(let o=0;o<s;o++)e+=a.get(t,o)*i.get(r,o);f.set(t,r,e)}return f.mmul(r)}solveForDiagonal(t){return this.solve(y.diag(t))}inverse(){var t=this.V,r=this.threshold,e=t.rows,s=t.columns,o=new y(e,this.s.length);for(let i=0;i<e;i++)for(let e=0;e<s;e++)Math.abs(this.s[e])>r&&o.set(i,e,t.get(i,e)/this.s[e]);var i=this.U,n=i.rows,a=i.columns,h=new y(e,n);for(let t=0;t<e;t++)for(let r=0;r<n;r++){let e=0;for(let s=0;s<a;s++)e+=o.get(t,s)*i.get(r,s);h.set(t,r,e)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,e=this.s,s=0,o=e.length;s<o;s++)e[s]>t&&r++;return r}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return y.diag(this.s)}}function T(t,r,e=!1){return t=R.checkMatrix(t),r=R.checkMatrix(r),e?new I(t).solve(r):t.isSquare()?new k(t).solve(r):new A(t).solve(r)}function q(t,r){for(var e=[],s=0;s<t;s++)s!==r&&e.push(s);return e}function C(t,r,e,s=1e-9,o=1e-9){if(t>o)return new Array(r.rows+1).fill(0);for(var i=r.addRow(e,[0]),n=0;n<i.rows;n++)Math.abs(i.get(n,0))<s&&i.set(n,0,0);return i.to1DArray()}class N{constructor(t,r={}){const{assumeSymmetric:e=!1}=r;if(!(t=R.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var s,o,i=t.columns,n=new y(i,i),a=new Array(i),h=new Array(i),u=t;if(!!e||t.isSymmetric()){for(s=0;s<i;s++)for(o=0;o<i;o++)n.set(s,o,u.get(s,o));!function(t,r,e,s){var o,i,n,a,h,u,f,c;for(h=0;h<t;h++)e[h]=s.get(t-1,h);for(a=t-1;a>0;a--){for(c=0,n=0,u=0;u<a;u++)c+=Math.abs(e[u]);if(0===c)for(r[a]=e[a-1],h=0;h<a;h++)e[h]=s.get(a-1,h),s.set(a,h,0),s.set(h,a,0);else{for(u=0;u<a;u++)e[u]/=c,n+=e[u]*e[u];for(o=e[a-1],i=Math.sqrt(n),o>0&&(i=-i),r[a]=c*i,n-=o*i,e[a-1]=o-i,h=0;h<a;h++)r[h]=0;for(h=0;h<a;h++){for(o=e[h],s.set(h,a,o),i=r[h]+s.get(h,h)*o,u=h+1;u<=a-1;u++)i+=s.get(u,h)*e[u],r[u]+=s.get(u,h)*o;r[h]=i}for(o=0,h=0;h<a;h++)r[h]/=n,o+=r[h]*e[h];for(f=o/(n+n),h=0;h<a;h++)r[h]-=f*e[h];for(h=0;h<a;h++){for(o=e[h],i=r[h],u=h;u<=a-1;u++)s.set(u,h,s.get(u,h)-(o*r[u]+i*e[u]));e[h]=s.get(a-1,h),s.set(a,h,0)}}e[a]=n}for(a=0;a<t-1;a++){if(s.set(t-1,a,s.get(a,a)),s.set(a,a,1),0!==(n=e[a+1])){for(u=0;u<=a;u++)e[u]=s.get(u,a+1)/n;for(h=0;h<=a;h++){for(i=0,u=0;u<=a;u++)i+=s.get(u,a+1)*s.get(u,h);for(u=0;u<=a;u++)s.set(u,h,s.get(u,h)-i*e[u])}}for(u=0;u<=a;u++)s.set(u,a+1,0)}for(h=0;h<t;h++)e[h]=s.get(t-1,h),s.set(t-1,h,0);s.set(t-1,t-1,1),r[0]=0}(i,h,a,n),function(t,r,e,s){var o,i,n,a,h,u,f,c,g,l,m,w,p,v,d,M;for(n=1;n<t;n++)r[n-1]=r[n];r[t-1]=0;var b=0,y=0,x=Number.EPSILON;for(u=0;u<t;u++){for(y=Math.max(y,Math.abs(e[u])+Math.abs(r[u])),f=u;f<t&&!(Math.abs(r[f])<=x*y);)f++;if(f>u)do{for(o=e[u],c=(e[u+1]-o)/(2*r[u]),g=V(c,1),c<0&&(g=-g),e[u]=r[u]/(c+g),e[u+1]=r[u]*(c+g),l=e[u+1],i=o-e[u],n=u+2;n<t;n++)e[n]-=i;for(b+=i,c=e[f],w=m=1,p=m,v=r[u+1],d=0,M=0,n=f-1;n>=u;n--)for(p=w,w=m,M=d,o=m*r[n],i=m*c,g=V(c,r[n]),r[n+1]=d*g,d=r[n]/g,c=(m=c/g)*e[n]-d*o,e[n+1]=i+d*(m*o+d*e[n]),h=0;h<t;h++)i=s.get(h,n+1),s.set(h,n+1,d*s.get(h,n)+m*i),s.set(h,n,m*s.get(h,n)-d*i);c=-d*M*p*v*r[u]/l,r[u]=d*c,e[u]=m*c}while(Math.abs(r[u])>x*y);e[u]=e[u]+b,r[u]=0}for(n=0;n<t-1;n++){for(h=n,c=e[n],a=n+1;a<t;a++)e[a]<c&&(h=a,c=e[a]);if(h!==n)for(e[h]=e[n],e[n]=c,a=0;a<t;a++)c=s.get(a,n),s.set(a,n,s.get(a,h)),s.set(a,h,c)}}(i,h,a,n)}else{var f=new y(i,i),c=new Array(i);for(o=0;o<i;o++)for(s=0;s<i;s++)f.set(s,o,u.get(s,o));!function(t,r,e,s){var o,i,n,a,h,u,f,c=t-1;for(u=1;u<=c-1;u++){for(f=0,a=u;a<=c;a++)f+=Math.abs(r.get(a,u-1));if(0!==f){for(n=0,a=c;a>=u;a--)e[a]=r.get(a,u-1)/f,n+=e[a]*e[a];for(i=Math.sqrt(n),e[u]>0&&(i=-i),n-=e[u]*i,e[u]=e[u]-i,h=u;h<t;h++){for(o=0,a=c;a>=u;a--)o+=e[a]*r.get(a,h);for(o/=n,a=u;a<=c;a++)r.set(a,h,r.get(a,h)-o*e[a])}for(a=0;a<=c;a++){for(o=0,h=c;h>=u;h--)o+=e[h]*r.get(a,h);for(o/=n,h=u;h<=c;h++)r.set(a,h,r.get(a,h)-o*e[h])}e[u]=f*e[u],r.set(u,u-1,f*i)}}for(a=0;a<t;a++)for(h=0;h<t;h++)s.set(a,h,a===h?1:0);for(u=c-1;u>=1;u--)if(0!==r.get(u,u-1)){for(a=u+1;a<=c;a++)e[a]=r.get(a,u-1);for(h=u;h<=c;h++){for(i=0,a=u;a<=c;a++)i+=e[a]*s.get(a,h);for(i=i/e[u]/r.get(u,u-1),a=u;a<=c;a++)s.set(a,h,s.get(a,h)+i*e[a])}}}(i,f,c,n),function(t,r,e,s,o){var i,n,a,h,u,f,c,g,l,m,w,p,v,d,M,b=t-1,y=t-1,x=Number.EPSILON,S=0,E=0,R=0,k=0,V=0,A=0,I=0,T=0;for(i=0;i<t;i++)for((i<0||i>y)&&(e[i]=o.get(i,i),r[i]=0),n=Math.max(i-1,0);n<t;n++)E+=Math.abs(o.get(i,n));for(;b>=0;){for(h=b;h>0&&(0===(A=Math.abs(o.get(h-1,h-1))+Math.abs(o.get(h,h)))&&(A=E),!(Math.abs(o.get(h,h-1))<x*A));)h--;if(h===b)o.set(b,b,o.get(b,b)+S),e[b]=o.get(b,b),r[b]=0,b--,T=0;else if(h===b-1){if(c=o.get(b,b-1)*o.get(b-1,b),R=(o.get(b-1,b-1)-o.get(b,b))/2,k=R*R+c,I=Math.sqrt(Math.abs(k)),o.set(b,b,o.get(b,b)+S),o.set(b-1,b-1,o.get(b-1,b-1)+S),g=o.get(b,b),k>=0){for(I=R>=0?R+I:R-I,e[b-1]=g+I,e[b]=e[b-1],0!==I&&(e[b]=g-c/I),r[b-1]=0,r[b]=0,g=o.get(b,b-1),A=Math.abs(g)+Math.abs(I),R=g/A,k=I/A,V=Math.sqrt(R*R+k*k),R/=V,k/=V,n=b-1;n<t;n++)I=o.get(b-1,n),o.set(b-1,n,k*I+R*o.get(b,n)),o.set(b,n,k*o.get(b,n)-R*I);for(i=0;i<=b;i++)I=o.get(i,b-1),o.set(i,b-1,k*I+R*o.get(i,b)),o.set(i,b,k*o.get(i,b)-R*I);for(i=0;i<=y;i++)I=s.get(i,b-1),s.set(i,b-1,k*I+R*s.get(i,b)),s.set(i,b,k*s.get(i,b)-R*I)}else e[b-1]=g+R,e[b]=g+R,r[b-1]=I,r[b]=-I;b-=2,T=0}else{if(g=o.get(b,b),l=0,c=0,h<b&&(l=o.get(b-1,b-1),c=o.get(b,b-1)*o.get(b-1,b)),10===T){for(S+=g,i=0;i<=b;i++)o.set(i,i,o.get(i,i)-g);A=Math.abs(o.get(b,b-1))+Math.abs(o.get(b-1,b-2)),g=l=.75*A,c=-.4375*A*A}if(30===T&&(A=(A=(l-g)/2)*A+c)>0){for(A=Math.sqrt(A),l<g&&(A=-A),A=g-c/((l-g)/2+A),i=0;i<=b;i++)o.set(i,i,o.get(i,i)-A);S+=A,g=l=c=.964}for(T+=1,u=b-2;u>=h&&(I=o.get(u,u),R=((V=g-I)*(A=l-I)-c)/o.get(u+1,u)+o.get(u,u+1),k=o.get(u+1,u+1)-I-V-A,V=o.get(u+2,u+1),A=Math.abs(R)+Math.abs(k)+Math.abs(V),R/=A,k/=A,V/=A,u!==h)&&!(Math.abs(o.get(u,u-1))*(Math.abs(k)+Math.abs(V))<x*(Math.abs(R)*(Math.abs(o.get(u-1,u-1))+Math.abs(I)+Math.abs(o.get(u+1,u+1)))));)u--;for(i=u+2;i<=b;i++)o.set(i,i-2,0),i>u+2&&o.set(i,i-3,0);for(a=u;a<=b-1&&(d=a!==b-1,a!==u&&(R=o.get(a,a-1),k=o.get(a+1,a-1),V=d?o.get(a+2,a-1):0,0!==(g=Math.abs(R)+Math.abs(k)+Math.abs(V))&&(R/=g,k/=g,V/=g)),0!==g);a++)if(A=Math.sqrt(R*R+k*k+V*V),R<0&&(A=-A),0!==A){for(a!==u?o.set(a,a-1,-A*g):h!==u&&o.set(a,a-1,-o.get(a,a-1)),g=(R+=A)/A,l=k/A,I=V/A,k/=R,V/=R,n=a;n<t;n++)R=o.get(a,n)+k*o.get(a+1,n),d&&(R+=V*o.get(a+2,n),o.set(a+2,n,o.get(a+2,n)-R*I)),o.set(a,n,o.get(a,n)-R*g),o.set(a+1,n,o.get(a+1,n)-R*l);for(i=0;i<=Math.min(b,a+3);i++)R=g*o.get(i,a)+l*o.get(i,a+1),d&&(R+=I*o.get(i,a+2),o.set(i,a+2,o.get(i,a+2)-R*V)),o.set(i,a,o.get(i,a)-R),o.set(i,a+1,o.get(i,a+1)-R*k);for(i=0;i<=y;i++)R=g*s.get(i,a)+l*s.get(i,a+1),d&&(R+=I*s.get(i,a+2),s.set(i,a+2,s.get(i,a+2)-R*V)),s.set(i,a,s.get(i,a)-R),s.set(i,a+1,s.get(i,a+1)-R*k)}}}if(0===E)return;for(b=t-1;b>=0;b--)if(R=e[b],0===(k=r[b]))for(h=b,o.set(b,b,1),i=b-1;i>=0;i--){for(c=o.get(i,i)-R,V=0,n=h;n<=b;n++)V+=o.get(i,n)*o.get(n,b);if(r[i]<0)I=c,A=V;else if(h=i,0===r[i]?o.set(i,b,0!==c?-V/c:-V/(x*E)):(g=o.get(i,i+1),l=o.get(i+1,i),k=(e[i]-R)*(e[i]-R)+r[i]*r[i],f=(g*A-I*V)/k,o.set(i,b,f),o.set(i+1,b,Math.abs(g)>Math.abs(I)?(-V-c*f)/g:(-A-l*f)/I)),f=Math.abs(o.get(i,b)),x*f*f>1)for(n=i;n<=b;n++)o.set(n,b,o.get(n,b)/f)}else if(k<0)for(h=b-1,Math.abs(o.get(b,b-1))>Math.abs(o.get(b-1,b))?(o.set(b-1,b-1,k/o.get(b,b-1)),o.set(b-1,b,-(o.get(b,b)-R)/o.get(b,b-1))):(M=j(0,-o.get(b-1,b),o.get(b-1,b-1)-R,k),o.set(b-1,b-1,M[0]),o.set(b-1,b,M[1])),o.set(b,b-1,0),o.set(b,b,1),i=b-2;i>=0;i--){for(m=0,w=0,n=h;n<=b;n++)m+=o.get(i,n)*o.get(n,b-1),w+=o.get(i,n)*o.get(n,b);if(c=o.get(i,i)-R,r[i]<0)I=c,V=m,A=w;else if(h=i,0===r[i]?(M=j(-m,-w,c,k),o.set(i,b-1,M[0]),o.set(i,b,M[1])):(g=o.get(i,i+1),l=o.get(i+1,i),p=(e[i]-R)*(e[i]-R)+r[i]*r[i]-k*k,v=2*(e[i]-R)*k,0===p&&0===v&&(p=x*E*(Math.abs(c)+Math.abs(k)+Math.abs(g)+Math.abs(l)+Math.abs(I))),M=j(g*V-I*m+k*w,g*A-I*w-k*m,p,v),o.set(i,b-1,M[0]),o.set(i,b,M[1]),Math.abs(g)>Math.abs(I)+Math.abs(k)?(o.set(i+1,b-1,(-m-c*o.get(i,b-1)+k*o.get(i,b))/g),o.set(i+1,b,(-w-c*o.get(i,b)-k*o.get(i,b-1))/g)):(M=j(-V-l*o.get(i,b-1),-A-l*o.get(i,b),I,k),o.set(i+1,b-1,M[0]),o.set(i+1,b,M[1]))),f=Math.max(Math.abs(o.get(i,b-1)),Math.abs(o.get(i,b))),x*f*f>1)for(n=i;n<=b;n++)o.set(n,b-1,o.get(n,b-1)/f),o.set(n,b,o.get(n,b)/f)}for(i=0;i<t;i++)if(i<0||i>y)for(n=i;n<t;n++)s.set(i,n,o.get(i,n));for(n=t-1;n>=0;n--)for(i=0;i<=y;i++){for(I=0,a=0;a<=Math.min(n,y);a++)I+=s.get(i,a)*o.get(a,n);s.set(i,n,I)}}(i,h,a,n,f)}this.n=i,this.e=h,this.d=a,this.V=n}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){var t,r,e=this.n,s=this.e,o=this.d,i=new y(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)i.set(t,r,0);i.set(t,t,o[t]),s[t]>0?i.set(t,t+1,s[t]):s[t]<0&&i.set(t,t-1,s[t])}return i}}function j(t,r,e,s){var o,i;return Math.abs(e)>Math.abs(s)?[(t+(o=s/e)*r)/(i=e+o*s),(r-o*t)/i]:[((o=e/s)*t+r)/(i=s+o*e),(o*r-t)/i]}class D{constructor(t){if(!(t=R.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var r,e,s,o=t,i=o.rows,n=new y(i,i),a=!0;for(e=0;e<i;e++){var h=0;for(s=0;s<e;s++){var u=0;for(r=0;r<s;r++)u+=n.get(s,r)*n.get(e,r);u=(o.get(e,s)-u)/n.get(s,s),n.set(e,s,u),h+=u*u}for(a&=(h=o.get(e,e)-h)>0,n.set(e,e,Math.sqrt(Math.max(h,0))),s=e+1;s<i;s++)n.set(e,s,0)}if(!a)throw new Error("Matrix is not positive definite");this.L=n}solve(t){t=R.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var s,o,i,n=t.columns,a=t.clone();for(i=0;i<e;i++)for(o=0;o<n;o++){for(s=0;s<i;s++)a.set(i,o,a.get(i,o)-a.get(s,o)*r.get(i,s));a.set(i,o,a.get(i,o)/r.get(i,i))}for(i=e-1;i>=0;i--)for(o=0;o<n;o++){for(s=i+1;s<e;s++)a.set(i,o,a.get(i,o)-a.get(s,o)*r.get(s,i));a.set(i,o,a.get(i,o)/r.get(i,i))}return a}get lowerTriangularMatrix(){return this.L}}r.AbstractMatrix=M,r.CHO=D,r.CholeskyDecomposition=D,r.EVD=N,r.EigenvalueDecomposition=N,r.LU=k,r.LuDecomposition=k,r.Matrix=y,r.MatrixColumnSelectionView=class extends x{constructor(t,r){r=c(t,r),super(t,t.rows,r.length),this.columnIndices=r}set(t,r,e){return this.matrix.set(t,this.columnIndices[r],e),this}get(t,r){return this.matrix.get(t,this.columnIndices[r])}},r.MatrixColumnView=class extends x{constructor(t,r){n(t,r),super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}},r.MatrixFlipColumnView=class extends x{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}},r.MatrixFlipRowView=class extends x{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}},r.MatrixRowSelectionView=class extends x{constructor(t,r){super(t,(r=f(t,r)).length,t.columns),this.rowIndices=r}set(t,r,e){return this.matrix.set(this.rowIndices[t],r,e),this}get(t,r){return this.matrix.get(this.rowIndices[t],r)}},r.MatrixRowView=class extends x{constructor(t,r){i(t,r),super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}},r.MatrixSelectionView=S,r.MatrixSubView=class extends x{constructor(t,r,e,s,o){g(t,r,e,s,o),super(t,e-r+1,o-s+1),this.startRow=r,this.startColumn=s}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}},r.MatrixTransposeView=class extends x{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}},r.QR=A,r.QrDecomposition=A,r.SVD=I,r.SingularValueDecomposition=I,r.WrapperMatrix1D=E,r.WrapperMatrix2D=R,r.default=y,r.determinant=function t(r){var e,s,o,i,n,a;if((r=y.checkMatrix(r)).isSquare())return 2===r.columns?(e=r.get(0,0),s=r.get(0,1),o=r.get(1,0),e*r.get(1,1)-s*o):3===r.columns?(i=new S(r,[1,2],[1,2]),n=new S(r,[1,2],[0,2]),a=new S(r,[1,2],[0,1]),e=r.get(0,0),s=r.get(0,1),o=r.get(0,2),e*t(i)-s*t(n)+o*t(a)):new k(r).determinant;throw Error("determinant can only be calculated for a square matrix")},r.inverse=function(t,r=!1){return t=R.checkMatrix(t),r?new I(t).inverse():T(t,y.eye(t.rows))},r.linearDependencies=function(t,r={}){const{thresholdValue:e=1e-9,thresholdError:s=1e-9}=r;for(var o=(t=y.checkMatrix(t)).rows,i=new y(o,o),n=0;n<o;n++){var a=y.columnVector(t.getRow(n)),h=t.subMatrixRow(q(o,n)).transpose(),u=new I(h).solve(a),f=y.sub(a,h.mmul(u)).abs().max();i.setRow(n,C(f,u,n,e,s))}return i},r.pseudoInverse=function(t,r=Number.EPSILON){t=y.checkMatrix(t);for(var e=new I(t,{autoTranspose:!0}),s=e.leftSingularVectors,o=e.rightSingularVectors,i=e.diagonal,n=0;n<i.length;n++)Math.abs(i[n])>r?i[n]=1/i[n]:i[n]=0;return o.mmul(y.diag(i).mmul(s.transpose()))},r.solve=T,r.wrap=function(t,r){if(Array.isArray(t))return t[0]&&Array.isArray(t[0])?new R(t):new E(t,r);throw new Error("the argument is not an array")}},function(t,r,e){"use strict";e.r(r);var s=e(0),o=e.n(s);var i=function(t){if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]>r&&(r=t[e]);return r};var n=function(t){if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]<r&&(r=t[e]);return r};r.default=function(t){var r,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==e.output){if(!o()(e.output))throw new TypeError("output option must be an array if specified");r=e.output}else r=new Array(t.length);var s=n(t),a=i(t);if(s===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=e.min,u=void 0===h?e.autoMinMax?s:0:h,f=e.max,c=void 0===f?e.autoMinMax?a:1:f;if(u>=c)throw new RangeError("min option must be smaller than max option");for(var g=(c-u)/(a-s),l=0;l<t.length;l++)r[l]=(t[l]-s)*g+u;return r}}])});